{"version":3,"file":"login-BY45mZaQ.js","sources":["../../src/js/login.js"],"sourcesContent":["// header.js\n(() => {\n  'use strict';\n\n  // ---------- Helpers ----------\n  const qs = (s, r = document) => r.querySelector(s);\n  const qsa = (s, r = document) => [...r.querySelectorAll(s)];\n\n  const header = qs('#site-header');\n  const burger = qs('#header-burger');\n  const mobileMenu = qs('#mobile-menu');\n  const srLive = qs('#sr-toast');\n\n  const modals = {\n    register: qs('#register-window'),\n    login: qs('#login-window'),\n  };\n\n  // ---------- Toast (SweetAlert2 + aria-live fallback) ----------\n  function showToast(message, type = 'success') {\n    if (window.Swal) {\n      Swal.fire({\n        toast: true,\n        icon: type,\n        title: message,\n        position: 'top-end',\n        showConfirmButton: false,\n        timer: 2600,\n        timerProgressBar: true,\n        didOpen: el => {\n          el.setAttribute('role', 'status');\n          el.setAttribute('aria-live', 'polite');\n        },\n      });\n    }\n    if (srLive) {\n      srLive.textContent = '';\n      setTimeout(() => {\n        srLive.textContent = message;\n      }, 50);\n    }\n  }\n\n  // ---------- Focus utils ----------\n  const getFocusables = root =>\n    qsa(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])',\n      root\n    ).filter(\n      el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden')\n    );\n\n  let activeModal = null;\n\n  // ---------- Animations ----------\n  function animateOpen(modal) {\n    modal.hidden = false;\n    modal.classList.remove('is-closing');\n    modal.classList.add('is-opening');\n    return new Promise(resolve => {\n      const onEnd = e => {\n        if (e && e.target !== modal) return;\n        modal.classList.remove('is-opening');\n        modal.removeEventListener('animationend', onEnd);\n        resolve();\n      };\n      modal.addEventListener('animationend', onEnd);\n    });\n  }\n\n  function animateClose(modal) {\n    modal.classList.remove('is-opening');\n    modal.classList.add('is-closing');\n    return new Promise(resolve => {\n      const onEnd = e => {\n        if (e && e.target !== modal) return;\n        modal.classList.remove('is-closing');\n        modal.hidden = true;\n        modal.removeEventListener('animationend', onEnd);\n        resolve();\n      };\n      modal.addEventListener('animationend', onEnd);\n    });\n  }\n\n  // ---------- Open / Close ----------\n  async function openModal(key) {\n    const modal = modals[key];\n    if (!modal || activeModal) return;\n\n    activeModal = modal;\n    await animateOpen(modal);\n\n    document.documentElement.style.overflow = 'hidden';\n    header?.setAttribute('aria-hidden', 'true');\n\n    // focus trap\n    const focusables = getFocusables(modal);\n    const first = focusables[0];\n    const last = focusables.at(-1);\n\n    modal._trap = e => {\n      if (e.key !== 'Tab') return;\n      if (e.shiftKey && document.activeElement === first) {\n        last.focus();\n        e.preventDefault();\n      } else if (!e.shiftKey && document.activeElement === last) {\n        first.focus();\n        e.preventDefault();\n      }\n    };\n    modal.addEventListener('keydown', modal._trap);\n    first?.focus();\n  }\n\n  async function closeModal() {\n    if (!activeModal) return;\n    const m = activeModal;\n\n    m.removeEventListener('keydown', m._trap || (() => {}));\n    await animateClose(m);\n\n    activeModal = null;\n    document.documentElement.style.overflow = '';\n    header?.removeAttribute('aria-hidden');\n  }\n\n  // ---------- Bind open/close triggers ----------\n  // open buttons: [data-open=\"login|register\"]\n  qsa('[data-open]').forEach(btn => {\n    btn.addEventListener('click', () => openModal(btn.dataset.open));\n  });\n\n  // close buttons: [data-close], click backdrop, Escape\n  qsa('[data-close]').forEach(btn => btn.addEventListener('click', closeModal));\n\n  qsa('.modal').forEach(m => {\n    m.addEventListener('mousedown', e => {\n      if (e.target === m) closeModal();\n    });\n  });\n\n  document.addEventListener('keydown', e => {\n    if (e.key === 'Escape') closeModal();\n  });\n\n  // ---------- Mobile menu ----------\n  burger?.addEventListener('click', () => {\n    const expanded = burger.getAttribute('aria-expanded') === 'true';\n    burger.setAttribute('aria-expanded', String(!expanded));\n    mobileMenu.hidden = expanded;\n  });\n\n  // ---------- Validation ----------\n  const re = {\n    username: /^[a-zA-Z0-9_]{3,20}$/,\n    email: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/,\n    strong:\n      /^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d!@#$%^&*()_+\\-={}[\\]:;\"'<>?,.\\/]{6,}$/,\n  };\n\n  function ensureErrorEl(input) {\n    let err = input.closest('.field')?.querySelector('.field__error');\n    if (!err) {\n      err = document.createElement('small');\n      err.className = 'field__error';\n      err.hidden = true;\n      input.closest('.field')?.appendChild(err);\n    }\n    if (!err.id) {\n      err.id = input.name\n        ? `err-${input.name}`\n        : `err-${Math.random().toString(36).slice(2)}`;\n    }\n    return err;\n  }\n\n  function setError(input, msg) {\n    const err = ensureErrorEl(input);\n    input.setAttribute('aria-invalid', 'true');\n    input.setAttribute('aria-describedby', err.id);\n    err.textContent = msg;\n    err.hidden = false;\n    input.closest('.field')?.classList.add('field--error');\n  }\n\n  function clearError(input) {\n    const err = input.closest('.field')?.querySelector('.field__error');\n    input.setAttribute('aria-invalid', 'false');\n    if (err) {\n      err.textContent = '';\n      err.hidden = true;\n    }\n    input.closest('.field')?.classList.remove('field--error');\n  }\n\n  function validateField(input) {\n    const name = input.name || '';\n    const val = input.value.trim();\n\n    if (name === 'username') {\n      if (!val) return setError(input, 'Введіть ім’я користувача');\n      if (!re.username.test(val))\n        return setError(input, '3–20 символів, латиниця/цифри/_');\n    }\n\n    if (name === 'email') {\n      if (!val) return setError(input, 'Введіть email');\n      if (!re.email.test(val)) return setError(input, 'Невірний формат email');\n    }\n\n    if (name === 'password') {\n      if (!val) return setError(input, 'Введіть пароль');\n      if (!re.strong.test(val))\n        return setError(input, 'Мінімум 6 символів, літера і цифра');\n    }\n\n    clearError(input);\n  }\n\n  function attachValidation(form) {\n    if (!form) return;\n\n    const inputs = form.querySelectorAll('.field__input[name]');\n    inputs.forEach(inp => {\n      inp.setAttribute('aria-invalid', 'false');\n      inp.addEventListener('input', () => validateField(inp));\n      inp.addEventListener('blur', () => validateField(inp));\n    });\n\n    form.addEventListener('submit', async e => {\n      let hasError = false;\n      inputs.forEach(inp => {\n        validateField(inp);\n        if (inp.getAttribute('aria-invalid') === 'true') hasError = true;\n      });\n\n      if (hasError) {\n        e.preventDefault();\n        // невеликий шейк (якщо є CSS .form.is-invalid .modal__dialog{ animation: shake ... })\n        form.classList.add('is-invalid');\n        setTimeout(() => form.classList.remove('is-invalid'), 420);\n        return;\n      }\n\n      // Тут твоя реальна логіка (fetch/await). Для демо — просто успіх:\n      e.preventDefault();\n      await closeModal();\n      showToast(\n        form.closest('#register-window')\n          ? 'Реєстрація успішна!'\n          : 'Вхід виконано!',\n        'success'\n      );\n    });\n  }\n\n  attachValidation(qs('#register-window form'));\n  attachValidation(qs('#login-window form'));\n})();\n"],"names":["qs","s","r","qsa","header","burger","mobileMenu","srLive","modals","showToast","message","type","el","getFocusables","root","activeModal","animateOpen","modal","resolve","onEnd","e","animateClose","openModal","key","focusables","first","last","closeModal","m","btn","expanded","re","ensureErrorEl","input","err","setError","msg","clearError","validateField","name","val","attachValidation","form","inputs","inp","hasError"],"mappings":"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"}